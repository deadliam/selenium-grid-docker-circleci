version: 2.0
jobs:
  setup_project:
    docker:
    - image: circleci/python:3.6.3
    steps:
    - checkout
    - run:
        name: Install Python dependencies in a venv
        command: |
          pip install virtualenv
          virtualenv venv
          . venv/bin/activate
          pip install --upgrade pip
          pip install -r requirements.txt
  chrome-tests:
    docker:
    - image: circleci/python:3.6.3
    - image: selenium/standalone-chrome:3.141.59-iron
    steps:
    - run:
        name: run tests chrome
        command: |
          . venv/bin/activate
          ./run-tests.sh -b chrome -p Tests
  firefox-tests:
    docker:
    - image: circleci/python:3.6.3
    - image: selenium/standalone-firefox:3.141.59-iron
    steps:
    - run:
        name: run tests firefox
        command: |
          . venv/bin/activate
          ./run-tests.sh -b firefox -p Tests
workflows:
  version: 2
  run_e2e_tests:
    jobs:
      - setup_project
      - chrome-tests:
          requires:
            - setup_project
      - firefox-tests:
          requires:
          - setup_project